{% extends 'curriculum/base.html' %}
{% load static %}

{% block title %}Trayectoria | {{ perfil.nombres }}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto pb-20 fade-in">
    
    <!-- Encabezado Editorial -->
    <div class="mb-20 relative">
        <div class="inline-flex items-center gap-2 mb-4">
            <span class="text-bloom-accent text-xl">êôö</span>
            <span class="text-bloom-accent dark:text-bloom-lime font-black tracking-[0.3em] text-[9px] uppercase">Professional Journey</span>
        </div>
        <h2 class="text-6xl md:text-8xl font-display font-black italic uppercase tracking-tighter text-bloom-espresso dark:text-white leading-none">
            Trayectoria <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-bloom-accent to-bloom-lime">Profesional</span>
        </h2>
        <div class="h-2 w-40 bg-bloom-lime mt-6 rounded-full shadow-[0_5px_15px_rgba(209,249,133,0.3)]"></div>
    </div>

    <div class="grid gap-16 relative">
        <!-- L√≠nea Cronol√≥gica Central Estilizada -->
        <div class="absolute left-0 lg:left-1/2 top-0 bottom-0 w-[2px] bg-gradient-to-b from-bloom-accent/50 via-bloom-lime to-bloom-accent/20 hidden md:block lg:transform lg:-translate-x-1/2"></div>
        
        {% for exp in experiencias %}
        <div class="relative flex flex-col lg:flex-row items-center justify-between group">
            
            <!-- Indicador Circular (Flor o Lazo) en la l√≠nea -->
            <div class="hidden lg:flex absolute left-1/2 top-12 -translate-x-1/2 w-12 h-12 bg-white dark:bg-bloom-cardDark border-4 border-bloom-lime rounded-full items-center justify-center z-20 shadow-xl group-hover:scale-125 group-hover:rotate-12 transition-all duration-500">
                <span class="text-bloom-accent text-xl">{% if forloop.first %}êôö{% else %}‚úø{% endif %}</span>
            </div>

            <!-- Contenido de la Experiencia -->
            <!-- L√≥gica: Si es par va a la derecha (order-last), si es impar a la izquierda -->
            <div class="w-full lg:w-[44%] {% if forloop.counter|divisibleby:2 %}lg:order-last lg:text-left{% else %}lg:text-right{% endif %}">
                <div class="bg-white dark:bg-bloom-cardDark p-10 rounded-[3.5rem] border border-bloom-accent/5 dark:border-white/5 shadow-sm hover:shadow-2xl dark:hover:shadow-bloom-lime/5 transition-all duration-700 relative overflow-hidden group/card">
                    
                    <!-- Resplandor de fondo en hover -->
                    <div class="absolute -right-20 -top-20 w-40 h-40 bg-bloom-lime/10 rounded-full blur-3xl opacity-0 group-hover/card:opacity-100 transition-opacity duration-700"></div>

                    <!-- Cabecera de la Tarjeta -->
                    <div class="flex flex-col {% if not forloop.counter|divisibleby:2 %}lg:items-end{% else %}lg:items-start{% endif %} mb-6">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="px-5 py-1.5 bg-bloom-espresso dark:bg-bloom-accent text-white dark:text-bloom-night text-[10px] font-black rounded-full uppercase tracking-widest shadow-lg">
                                REG. {{ forloop.counter|stringformat:"02d" }}
                            </span>
                        </div>
                        <span class="text-bloom-accent dark:text-bloom-lime font-display font-black text-lg italic tracking-tight">
                            {{ exp.fecha_inicio|date:"M Y" }} ‚Äî {% if exp.activo %}Presente{% else %}{{ exp.fecha_fin|date:"M Y" }}{% endif %}
                        </span>
                    </div>
                    
                    <h3 class="text-3xl font-display font-black uppercase text-bloom-espresso dark:text-zinc-100 group-hover/card:text-bloom-accent transition-colors leading-none mb-3">
                        {{ exp.cargo }}
                    </h3>
                    
                    <p class="text-bloom-lime dark:text-bloom-lime font-body font-black text-[11px] uppercase mb-8 tracking-[0.2em] flex items-center {% if not forloop.counter|divisibleby:2 %}lg:justify-end{% endif %} gap-3">
                        <i data-lucide="building" size="14"></i>
                        {{ exp.empresa }} 
                        <span class="text-bloom-pink/50">‚ú¶</span> 
                        <span class="text-gray-400 font-medium lowercase italic">Curated Experience</span>
                    </p>
                    
                    <div class="relative">
                        <p class="text-gray-500 dark:text-gray-400 text-sm font-body leading-relaxed {% if not forloop.counter|divisibleby:2 %}lg:pl-12 lg:border-r-2 lg:border-l-0{% else %}pl-6 border-l-2{% endif %} border-bloom-pink dark:border-white/5 italic">
                            "{{ exp.descripcion }}"
                        </p>
                    </div>

                    <!-- Sello de Lazo Decorativo -->
                    <div class="absolute bottom-6 {% if not forloop.counter|divisibleby:2 %}left-8{% else %}right-8{% endif %} opacity-0 group-hover/card:opacity-20 transition-all duration-700">
                        <span class="text-6xl">êôö</span>
                    </div>
                </div>
            </div>

            <!-- Espaciador para la otra columna en desktop -->
            <div class="hidden lg:block lg:w-[44%]"></div>
        </div>
        {% empty %}
        <!-- Estado Vac√≠o Bloom Style -->
        <div class="bg-white dark:bg-bloom-cardDark p-20 rounded-[5rem] border-2 border-dashed border-bloom-accent/20 text-center col-span-full">
            <div class="w-24 h-24 bg-bloom-pink dark:bg-white/5 rounded-full flex items-center justify-center mx-auto mb-8 shadow-inner animate-bounce">
                <i data-lucide="flower-2" class="text-bloom-accent animate-pulse" size="48"></i>
            </div>
            <h4 class="text-bloom-espresso dark:text-white font-display font-black text-2xl uppercase tracking-tighter mb-2">Sembrando el camino</h4>
            <p class="text-gray-400 font-body italic">A√∫n no se han registrado experiencias en esta bit√°cora creativa.</p>
        </div>
        {% endfor %}
    </div>

    <!-- Call to Action Inferior -->
    <div class="mt-24 text-center">
        <p class="text-bloom-accent dark:text-bloom-lime font-black uppercase tracking-[0.4em] text-[10px] mb-8">Ready for the next big thing?</p>
        <a href="{% url 'contacto' %}" class="inline-flex items-center gap-4 px-12 py-6 bg-bloom-espresso dark:bg-bloom-accent text-white dark:text-bloom-night font-black rounded-full shadow-2xl hover:scale-105 hover:bg-bloom-lime hover:text-bloom-espresso transition-all duration-500 uppercase text-[11px] tracking-widest">
            Hablemos de nuevos proyectos <i data-lucide="message-circle" size="18"></i>
        </a>
    </div>
</div>

<style>
    /* Estilos espec√≠ficos para esta p√°gina */
    .font-display { font-family: 'Fraunces', serif; }
    .font-body { font-family: 'Outfit', sans-serif; }

    .fade-in { animation: fadeIn 1s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    
    /* Animaci√≥n de entrada escalonada para las tarjetas usando el √≠ndice del loop de Django */
    .group { animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) both; }
    
    {% for exp in experiencias %}
    .group:nth-child({{ forloop.counter }}) { animation-delay: {{ forloop.counter|add:"0.2" }}s; }
    {% endfor %}

    @keyframes slideIn {
        from { opacity: 0; transform: translateY(40px) scale(0.95); }
        to { opacity: 1; transform: translateY(0) scale(1); }
    }
</style>
{% endblock %}