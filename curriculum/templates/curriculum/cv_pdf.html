<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>CV - {{ perfil.nombres }}</title>
    <style>
        /* CSS LIMPIO PARA PDF (Sin animaciones ni Tailwind) */
        @page {
            size: a4;
            margin: 1.2cm;
        }

        body {
            font-family: 'Helvetica', 'Arial', sans-serif; /* Fuentes seguras para PDF */
            color: #3E2723;
            line-height: 1.5;
            font-size: 10pt;
            background-color: #ffffff;
        }

        /* Tablas para estructura (xhtml2pdf maneja mejor tablas que flexbox/grid) */
        .main-table {
            width: 100%;
            border-collapse: collapse;
        }

        .sidebar-cell {
            width: 28%;
            vertical-align: top;
            padding-right: 15px;
            border-right: 1.5pt solid #F4C9D6;
        }

        .content-cell {
            width: 72%;
            vertical-align: top;
            padding-left: 20px;
        }

        /* Imágenes */
        .profile-img {
            width: 130px;
            height: 160px;
            object-fit: cover; /* Nota: xhtml2pdf a veces ignora object-fit, mejor recortar la imagen antes */
            border: 2pt solid #3E2723;
            margin-bottom: 15px;
        }

        /* Textos */
        .name {
            font-size: 24pt;
            font-weight: bold;
            text-transform: uppercase;
            color: #3E2723;
            margin: 0;
            line-height: 1.1;
        }

        .job-title {
            font-size: 11pt;
            color: #3E2723;
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 20px;
            letter-spacing: 1px;
            opacity: 0.8;
        }

        .section-title {
            font-size: 13pt;
            font-weight: bold;
            text-transform: uppercase;
            color: #3E2723;
            border-bottom: 1.5pt solid #F4C9D6;
            margin-bottom: 10px;
            margin-top: 15px;
            padding-bottom: 2px;
        }

        .sidebar-title {
            font-size: 10pt;
            font-weight: bold;
            text-transform: uppercase;
            color: #3E2723;
            border-bottom: 0.5pt solid #F4C9D6;
            margin-top: 15px;
            margin-bottom: 8px;
            padding-bottom: 1px;
        }

        /* Detalles */
        .data-item {
            margin-bottom: 6px;
            font-size: 9pt;
        }
        .data-label {
            font-weight: bold;
            color: #3E2723;
            display: block;
            font-size: 8pt;
            text-transform: uppercase;
            opacity: 0.7;
        }
        .data-value {
            color: #3E2723;
            display: block;
            word-wrap: break-word;
        }

        .job-header {
            font-weight: bold;
            font-size: 11pt;
            color: #3E2723;
        }
        .job-sub {
            font-style: italic;
            color: #3E2723;
            font-weight: bold;
            font-size: 9pt;
            margin-bottom: 3px;
            opacity: 0.8;
        }
        .job-desc {
            text-align: justify;
            margin-bottom: 12px;
            font-size: 9.5pt;
            color: #3E2723;
        }

        .tag-pill {
            display: inline-block;
            background-color: #F4C9D6;
            color: #3E2723;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 8.5pt;
            margin-right: 4px;
            margin-bottom: 4px;
            font-weight: bold;
        }

        .footer-simple {
            text-align: center;
            font-size: 8pt;
            color: #3E2723;
            opacity: 0.5;
            border-top: 0.5pt solid #F4C9D6;
            margin-top: 20px;
            padding-top: 8px;
        }
    </style>
</head>
<body>

    <table class="main-table">
        <tr>
            <!-- COLUMNA IZQUIERDA -->
            <td class="sidebar-cell">
                <div style="text-align: center;">
                    {% if not ocultar_foto %}
                        {% if perfil.foto %}
                            <!-- USAMOS .url PARA EVITAR NotImplementedError EN LA NUBE -->
                            <img src="{{ perfil.foto.url }}" class="profile-img">
                        {% else %}
                            <div style="width: 130px; height: 160px; background: #fdfdfd; border: 2pt solid #3E2723; margin: 0 auto 15px auto; line-height: 160px; color: #3E2723; font-size: 8pt; opacity: 0.3;">SIN FOTO</div>
                        {% endif %}
                    {% endif %}
                </div>

                <div class="sidebar-title">Identificación</div>
                <div class="data-item">
                    <span class="data-label">Cédula / ID</span>
                    <span class="data-value">{{ perfil.cedula }}</span>
                </div>
                <div class="data-item">
                    <span class="data-label">Nacimiento</span>
                    <span class="data-value">{{ perfil.fecha_nacimiento|date:"d/m/Y" }}</span>
                </div>
                <div class="data-item">
                    <span class="data-label">Estado Civil</span>
                    <span class="data-value">{{ perfil.estado_civil }}</span>
                </div>
                {% if perfil.licencia %}
                <div class="data-item">
                    <span class="data-label">Licencia</span>
                    <span class="data-value">{{ perfil.licencia }}</span>
                </div>
                {% endif %}

                {% if not ocultar_contacto %}
                <div class="sidebar-title">Contacto</div>
                <div class="data-item">
                    <span class="data-label">Teléfono</span>
                    <span class="data-value">{{ perfil.telefono }}</span>
                </div>
                <div class="data-item">
                    <span class="data-label">Email</span>
                    <span class="data-value" style="font-size: 8pt;">{{ perfil.email }}</span>
                </div>
                {% if perfil.sitio_web %}
                <div class="data-item">
                    <span class="data-label">Sitio Web</span>
                    <span class="data-value">{{ perfil.sitio_web }}</span>
                </div>
                {% endif %}
                {% endif %}

                {% if not ocultar_idiomas %}
                {% if perfil.idiomas.exists %}
                <div class="sidebar-title">Idiomas</div>
                {% for idioma in perfil.idiomas.all %}
                <div class="data-item">
                    <span class="data-label">{{ idioma.nombre }}</span>
                    <span class="data-value">{{ idioma.nivel }}</span>
                </div>
                {% endfor %}
                {% endif %}
                {% endif %}

                {% if not ocultar_redes %}
                <div class="sidebar-title">Redes Sociales</div>
                {% if perfil.url_linkedin %}<div class="data-item"><span class="data-value">LinkedIn</span></div>{% endif %}
                {% if perfil.url_github %}<div class="data-item"><span class="data-value">GitHub</span></div>{% endif %}
                {% if perfil.url_instagram %}<div class="data-item"><span class="data-value">Instagram</span></div>{% endif %}
                {% if perfil.url_youtube %}<div class="data-item"><span class="data-value">YouTube</span></div>{% endif %}
                {% if perfil.url_tiktok %}<div class="data-item"><span class="data-value">TikTok</span></div>{% endif %}
                {% endif %}
            </td>

            <!-- COLUMNA DERECHA -->
            <td class="content-cell">
                <div class="name">{{ perfil.nombres }}<br>{{ perfil.apellidos }}</div>
                <div class="job-title">Curriculum Vitae Profesional</div>

                {% if not ocultar_perfil %}
                {% if perfil.descripcion_perfil %}
                <div class="section-title">Perfil Profesional</div>
                <div class="job-desc">
                    {{ perfil.descripcion_perfil }}
                </div>
                {% endif %}
                {% endif %}

                {% if not ocultar_intereses %}
                {% if perfil.intereses %}
                <div class="section-title">Intereses & Aptitudes</div>
                <div class="job-desc" style="font-style: italic; opacity: 0.9;">
                    {{ perfil.intereses }}
                </div>
                {% endif %}
                {% endif %}

                {% if not ocultar_experiencia %}
                {% if experiencias %}
                <div class="section-title">Trayectoria Laboral</div>
                {% for exp in experiencias %}
                <div style="margin-bottom: 12px;">
                    <div class="job-header">{{ exp.cargo }}</div>
                    <div class="job-sub">{{ exp.empresa }} | {{ exp.fecha_inicio|date:"M Y" }} - {% if exp.activo %}Actualidad{% else %}{{ exp.fecha_fin|date:"M Y" }}{% endif %}</div>
                    <div class="job-desc">{{ exp.descripcion }}</div>
                </div>
                {% endfor %}
                {% endif %}
                {% endif %}

                {% if not ocultar_educacion %}
                {% if estudios %}
                <div class="section-title">Formación Académica</div>
                {% for est in estudios %}
                <div style="margin-bottom: 8px;">
                    <div class="job-header">{{ est.titulo }}</div>
                    <div class="job-sub">{{ est.institucion }} | {{ est.fecha_fin|date:"Y" }}</div>
                </div>
                {% endfor %}
                {% endif %}
                {% endif %}

                {% if not ocultar_proyectos %}
                {% if proyectos %}
                <div class="section-title">Proyectos Académicos</div>
                {% for pro in proyectos %}
                <div style="margin-bottom: 8px;">
                    <div class="job-header">{{ pro.nombre }}</div>
                    <div class="job-sub">{{ pro.fecha_publicacion|date:"Y" }}</div>
                    {% if pro.descripcion %}
                    <div class="job-desc">{{ pro.descripcion }}</div>
                    {% endif %}
                </div>
                {% endfor %}
                {% endif %}
                {% endif %}

                {% if not ocultar_cursos %}
                {% if cursos %}
                <div class="section-title">Capacitaciones & Cursos</div>
                {% for curso in cursos %}
                <div style="margin-bottom: 8px;">
                    <div class="job-header">{{ curso.nombre_curso }}</div>
                    <div class="job-sub">{{ curso.institucion }} | {{ curso.fecha_realizacion|date:"Y" }} ({{ curso.horas }}h)</div>
                </div>
                {% endfor %}
                {% endif %}
                {% endif %}

                {% if not ocultar_reconocimientos %}
                {% if reconocimientos %}
                <div class="section-title">Reconocimientos</div>
                {% for rec in reconocimientos %}
                <div style="margin-bottom: 8px;">
                    <div class="job-header">{{ rec.nombre }}</div>
                    <div class="job-sub">{{ rec.institucion }} | {{ rec.fecha_obtencion|date:"Y" }}</div>
                </div>
                {% endfor %}
                {% endif %}
                {% endif %}

                {% if not ocultar_valores %}
                {% if perfil.valores_profesionales %}
                <div class="section-title">Valores Profesionales</div>
                <div style="margin-bottom: 10px;">
                    {% for valor in perfil.valores_profesionales.split %}
                        <span class="tag-pill">{{ valor|cut:"," }}</span>
                    {% endfor %}
                </div>
                {% endif %}
                {% endif %}
            </td>
        </tr>
    </table>

    <div class="footer-simple">
        {{ perfil.nombres }} {{ perfil.apellidos }} - Documento generado automáticamente - 2026
    </div>

</body>
</html>